<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        AN Lab 1 - QoS - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.figma{display:table;position:relative;width:100%;padding-bottom:56.25%}.figma iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;border:1px solid #eee}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{height:40px;padding:10px 4px;border-top-left-radius:0;border-bottom-left-radius:0}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:20px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:50%;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;text-decoration:none;padding-left:22px}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em;font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true"><h1 id="AN-Lab-1---QoS" data-id="AN-Lab-1---QoS" data-original-title="" title=""><a class="anchor hidden-xs" href="#AN-Lab-1---QoS" title="AN-Lab-1---QoS"><span class="octicon octicon-link"></span></a><span>AN Lab 1 - QoS</span></h1><p><strong><span>Name: Vladimir Shelkovnikov</span></strong></p><hr><h2 id="Task-1---Prepare-your-network-topology" data-id="Task-1---Prepare-your-network-topology"><a class="anchor hidden-xs" href="#Task-1---Prepare-your-network-topology" title="Task-1---Prepare-your-network-topology"><span class="octicon octicon-link"></span></a><span>Task 1 - Prepare your network topology</span></h2><div class="alert alert-success">
<ol>
<li><span>In the GNS3 project, select and install a virtual routing solution that you would like to use: Mikrotik (recommended), Pfsense, vyos and so on.</span></li>
<li><span>Prepare a simple network consisting of at least one router and two hosts. About four hosts in  the network are most optimal. You also might need Internet access for the hosts.</span></li>
</ol>
</div><p><span>I chose MikroTik as my virtual routing solution and prepared a simple network topology in Figure 1.</span></p><center>
<p><img src="https://i.imgur.com/aoAXJJw.png" alt="" loading="lazy"><br>
<span>Figure 1 - Simple topology</span></p>
</center><p><span>I have set up Ubuntu Cloud Guests (PCs) with netplan. Figure 2 shows an example of the configuration.</span></p><center>
<p><img src="https://i.imgur.com/bFtuRDb.png" alt="" loading="lazy"><br>
<span>Figure 2 - PC1 Configuration</span></p>
</center><p><span>Then I configured the router by adding port addresses (Figure 3) and NAT (Figure 4).</span></p><center>
<p><img src="https://i.imgur.com/mkbuiE0.png" alt="" loading="lazy"><br>
<span>Figure 3 - Router IP addresses</span></p>
<p><img src="https://i.imgur.com/07VvvG5.png" alt="" loading="lazy"><br>
<span>Figure 4 - Configuring NAT in MikroTik</span></p>
</center><p><span>Let’s check the connection between computers and Internet access (Figure 5).</span></p><center>
<p data-original-title="" title=""><img src="https://i.imgur.com/jZv4Gzs.png" alt="" loading="lazy"><br>
<span>Figure 5 - Checking connections</span></p>
</center><p><span>Then I restarted my network and ran the </span><code>sudo apt update</code><span> command on the PCs. At this stage, my network is configured.</span></p><hr><h2 id="Task-2---QoS-learning-amp-configuring" data-id="Task-2---QoS-learning-amp-configuring"><a class="anchor hidden-xs" href="#Task-2---QoS-learning-amp-configuring" title="Task-2---QoS-learning-amp-configuring"><span class="octicon octicon-link"></span></a><span>Task 2 - QoS learning &amp; configuring</span></h2><div class="alert alert-success">
<ol>
<li><span>Let’s start with a little theory. Briefly answer the questions or give one-line description what is it: Сlass of Service (CoS), Type Of Service (ToS), Differentiated Services Code Point (DSCP), Serialization, Packet Marking, Tail Drop, Head Drop, The Leaky bucket algorithm, The Token Bucket Algorithm, Traffic shaping, Traffic policing?</span></li>
</ol>
</div><hr><blockquote>
<h4 id="Сlass-of-Service-CoS" data-id="Сlass-of-Service-CoS"><a class="anchor hidden-xs" href="#Сlass-of-Service-CoS" title="Сlass-of-Service-CoS"><span class="octicon octicon-link"></span></a><span>Сlass of Service (CoS)</span></h4>
<blockquote>
<p><span>Сlass of Service (CoS) - a 3-bit field in the 802.1Q tag of the Ethernet frame. This is a traffic management method that allows you to group traffic of the same type together and then process it differently, depending on priority.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<h4 id="Type-Of-Service-ToS" data-id="Type-Of-Service-ToS"><a class="anchor hidden-xs" href="#Type-Of-Service-ToS" title="Type-Of-Service-ToS"><span class="octicon octicon-link"></span></a><span>Type Of Service (ToS)</span></h4>
<blockquote>
<p><span>Type Of Service (ToS) - a 1-byte field in the IP header. It is intended for marking traffic at the network level.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<h4 id="Differentiated-Services-Code-Point-DSCP" data-id="Differentiated-Services-Code-Point-DSCP"><a class="anchor hidden-xs" href="#Differentiated-Services-Code-Point-DSCP" title="Differentiated-Services-Code-Point-DSCP"><span class="octicon octicon-link"></span></a><span>Differentiated Services Code Point (DSCP)</span></h4>
<blockquote>
<p><span>Differentiated Services Code Point (DSCP) - six bits (DS5-DS0). Packets are assigned priorities using DSCP for classification.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<h4 id="Serialization" data-id="Serialization"><a class="anchor hidden-xs" href="#Serialization" title="Serialization"><span class="octicon octicon-link"></span></a><span>Serialization</span></h4>
<blockquote>
<p><span>Serialization is the time taken by the equipment to move bits of information into the transmission channel.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<h4 id="Packet-Marking" data-id="Packet-Marking"><a class="anchor hidden-xs" href="#Packet-Marking" title="Packet-Marking"><span class="octicon octicon-link"></span></a><span>Packet Marking</span></h4>
<blockquote>
<p><span>We mark a value in a packet to indicate the service class of this packet.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<h4 id="Tail-Drop" data-id="Tail-Drop"><a class="anchor hidden-xs" href="#Tail-Drop" title="Tail-Drop"><span class="octicon octicon-link"></span></a><span>Tail Drop</span></h4>
<blockquote>
<p><span>When the queue is full, usually delete the last packets that arrived. Since newly arrived packages are placed at the end of the queue, this behavior is called “tail drop”.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<h4 id="Head-Drop" data-id="Head-Drop"><a class="anchor hidden-xs" href="#Head-Drop" title="Head-Drop"><span class="octicon octicon-link"></span></a><span>Head Drop</span></h4>
<blockquote>
<p><span>Head Drop drops packets that have been in the queue for a very long time (the ones at the very head of the queue).</span></p>
</blockquote>
</blockquote><hr><blockquote>
<h4 id="The-Leaky-bucket-algorithm" data-id="The-Leaky-bucket-algorithm"><a class="anchor hidden-xs" href="#The-Leaky-bucket-algorithm" title="The-Leaky-bucket-algorithm"><span class="octicon octicon-link"></span></a><span>The Leaky bucket algorithm</span></h4>
<blockquote>
<p><span>The principle is as follows: each host connects to the network through an interface containing a “leaky bucket”. In order for the packet to be sent to the network, there should be enough space for it in the bucket. If the bucket is full when the packets arrive, the packets are either queued until there is enough space in the bucket, or rejected.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<h4 id="The-Token-Bucket-Algorithm" data-id="The-Token-Bucket-Algorithm"><a class="anchor hidden-xs" href="#The-Token-Bucket-Algorithm" title="The-Token-Bucket-Algorithm"><span class="octicon octicon-link"></span></a><span>The Token Bucket Algorithm</span></h4>
<blockquote>
<p><span>To send a packet, it is necessary that markers (contents of the bucket) can be poured out of the bucket, and not pour it there. A bucket can contain a limited number of tokens (no more than the bucket); if the bucket is empty, you must wait until new tokens appear to send the packet.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<h4 id="Traffic-shaping" data-id="Traffic-shaping"><a class="anchor hidden-xs" href="#Traffic-shaping" title="Traffic-shaping"><span class="octicon octicon-link"></span></a><span>Traffic shaping</span></h4>
<blockquote>
<p><span>Traffic shaping - a method for adjusting the average speed and uniformity of the input data flow. When a stream is established, the user and the network agree on a certain scheme (form) of traffic for this stream.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<h4 id="Traffic-policing" data-id="Traffic-policing"><a class="anchor hidden-xs" href="#Traffic-policing" title="Traffic-policing"><span class="octicon octicon-link"></span></a><span>Traffic policing</span></h4>
<blockquote>
<p><span>Traffic policing - this is a measure of forced impact on traffic aimed at limiting the speed of packet flow. The purpose of profiling is to ensure that the packet flow corresponds to a given speed profile - a set of specified flow parameters. It can be done in two ways: either discard some packets from the stream or delay them for a while in the buffer.</span></p>
</blockquote>
</blockquote><hr><p><span>Figure 6 shows the difference between shaping and policing.</span></p><center>
<p><img src="https://i.imgur.com/9gdzYYf.png" alt="" loading="lazy"><br>
<span>Figure 6 - Difference between shaping and policing</span></p>
</center><hr><div class="alert alert-success">
<ol start="2">
<li><span>Configure your network as you decided earlier. After your network is configured (don’t forget to show the main configuration steps in the report), try to set a speed limitation (traffic shaping) between the two hosts.</span><br>
<span>Hint: It was found that the virtual solution for the Mikrotik router has a “sewn” in the firmware speed limit of not more than one megabit per second, that is, in these conditions, we can only configure the speed limit of not more than one megabit per second. Try to verify this and to get around the restriction (could it have been fixed in the specific version)? Otherwise, set the traffic limit to no more than one megabit per second.</span></li>
<li><span>Run a bandwidth testing tool, see what is the max speed you can get, and verify your speed limitation. Compare the speed between the different hosts.</span><br>
<span>Hint: for example, you can use the iperf3 tool.</span></li>
</ol>
</div><h4 id="QOS-Capabilities-in-MicroTik" data-id="QOS-Capabilities-in-MicroTik"><a class="anchor hidden-xs" href="#QOS-Capabilities-in-MicroTik" title="QOS-Capabilities-in-MicroTik"><span class="octicon octicon-link"></span></a><span>QOS Capabilities in MicroTik</span></h4><p><span>To begin with, let’s briefly consider what the main QoS features are in MicroTik.</span></p><ul>
<li><span>Speed limit and prioritization based on IP, MAC, port, and interface (e.g. wifi), subnet, protocol, etc.</span></li>
<li><span>The possibility of a short-term increase in speed.</span></li>
<li><span>Setting up different time of day limits.</span></li>
<li><span>Distribution of channel width between users evenly or according to some rules.</span></li>
<li><span>And much more.</span></li>
</ul><p><span>All QoS configuration is performed in a separate section of the management interface called Queues.</span></p><p><span>Now let’s see if there is a traffic limitation (Figures 7 and 8).</span></p><center>
<p><img src="https://i.imgur.com/lBFgUL8.png" alt="" loading="lazy"><br>
<span>Figure 7 - There is traffic limitation</span></p>
<p><img src="https://i.imgur.com/4c4yAhf.png" alt="" loading="lazy"><br>
<span>Figure 8 - There is a traffic limitation for two PCs</span></p>
</center><p><span>This is the limit for the amount of traffic across all Mikrotik ports, as we see in Figure 8. Only PC1 for 0-15 seconds, then PS2 also runs the bandwidth test. The bandwidth of PC1+PC2 cannot exceed 1M.</span></p><p><span>I’ve tried this for versions 7.0 beta 8, 6.47, and 6.42. They all have this limitation. Officially, this restriction can be circumvented by purchasing a license. But there is a 60-day trial version. So I registered on </span><a href="http://Mikrotik.com" target="_blank" rel="noopener"><span>Mikrotik.com</span></a><span>. After this period, I will still have a license, but I will not be able to receive updates.</span></p><p><span>After the initial setup, the CHR instance will be assigned a free license (Figure 9).</span></p><center>
<p><img src="https://i.imgur.com/FCvJi7P.png" alt="" loading="lazy"><br>
<span>Figure 9 - Free license</span></p>
</center><p><span>From there, I can upgrade the license to a higher level, as shown in Figure 10.</span></p><center>
<p><img src="https://i.imgur.com/J3AIUSu.png" alt="" loading="lazy"><br>
<span>Figure 10 - Unlimited license</span></p>
</center><p><span>Let’s check the bandwidth again (Figure 11).</span></p><center>
<p><img src="https://i.imgur.com/lHiSzP9.png" alt="" loading="lazy"><br>
<span>Figure 11 - No restrictions</span></p>
</center><p><span>So now let’s set the speed limit for the PC2. To do this, I created a new rule to limit all traffic for 10.1.1.3 to 10M as shown in Figure 12.</span></p><center>
<p><img src="https://i.imgur.com/S61vMxw.png" alt="" loading="lazy"><br>
<span>Figure 12 - QoS rule to limit</span></p>
</center><p><span>Figure 13 shows that it is limited.</span></p><center>
<p data-original-title="" title=""><img src="https://i.imgur.com/WrFeWTn.png" alt="" loading="lazy"><br>
<span>Figure 13 - Bandwidth limit up to 10M</span></p>
</center><hr><div class="alert alert-success">
<ol start="4">
<li><span>While your bandwidth test is still running, try to download a file from one host to the other host and see what is the max speed you can get. If you have more than two hosts on the network, play around with different speed values and show it.</span><br>
<span>Hint 1: you can use any other scenario than download a file, for example, a VoIP call or streamed media.</span><br>
<span>Hint 2: for example, you can use iftop tool for speed measurement.</span></li>
</ol>
</div><p><span>I am going to test two scenarios:</span></p><ul>
<li><span>two PC on the same interface</span></li>
<li><span>two PC on the different interfaces</span></li>
</ul><hr><center>
<h3 id="Two-PC-on-the-different-interfaces" data-id="Two-PC-on-the-different-interfaces"><a class="anchor hidden-xs" href="#Two-PC-on-the-different-interfaces" title="Two-PC-on-the-different-interfaces"><span class="octicon octicon-link"></span></a><span>Two PC on the different interfaces</span></h3>
</center><hr><p><span>I started the bandwidth test (Figure 14) on PC1 and then started the download (Figure 15) on PC3.</span></p><center>
<p><img src="https://i.imgur.com/92M4a1o.png" alt="" loading="lazy"><br>
<span>Figure 14 - Running a bandwidth test</span></p>
<p><img src="https://i.imgur.com/IHhNZ9W.png" alt="" loading="lazy"><br>
<span>Figure 15 - Bandwidth test and downloading file</span></p>
</center><p><span>The maximum loading speed was 60 M/s.</span></p><hr><center>
<h3 id="Two-PC-on-the-same-interfaces" data-id="Two-PC-on-the-same-interfaces"><a class="anchor hidden-xs" href="#Two-PC-on-the-same-interfaces" title="Two-PC-on-the-same-interfaces"><span class="octicon octicon-link"></span></a><span>Two PC on the same interfaces</span></h3>
</center><hr><p><span>I started the bandwidth test (Figure 16) on PC1 and then started the download (Figures 17, 18) on PC3.</span></p><center>
<p><img src="https://i.imgur.com/v0l1AMA.png" alt="" loading="lazy"><br>
<span>Figure 16 - Running a bandwidth test</span></p>
</center><p><span>Here from the 20th second, I started downloading.</span></p><center>
<p><img src="https://i.imgur.com/23CfxEO.png" alt="" loading="lazy"><br>
<span>Figure 17 - Download speed with bandwidth test</span></p>
</center><p><span>During the bandwidth test, the download speed did not exceed 35 M/s.</span></p><center>
<p data-original-title="" title=""><img src="https://i.imgur.com/Ly0fVsl.png" alt="" loading="lazy"><br>
<span>Figure 18 - Bandwidth test and downloading file</span></p>
</center><p><span>During loading, the throughput test values dropped to 40 M/s, but then returned to 60 (Figure 19).</span></p><center>
<p><img src="https://i.imgur.com/bCkLbyK.png" alt="" loading="lazy"><br>
<span>Figure 19 - Bandwidth test after downloading file (after 90s)</span></p>
</center><hr><div class="alert alert-success">
<ol start="5">
<li><span>Deploy and verify your QoS rules to prioritize the downloading of a file (or any other scenario) over the bandwidth test.</span></li>
</ol>
</div><p><span>Since I download files between hosts using SSH protocol, I need to mark traffic on port 22. I can do this by using </span><code>ip firewall mangle</code><span> (Figure 20).</span></p><center>
<p><img src="https://i.imgur.com/j1eIavc.png" alt="" loading="lazy"><br>
<span>Figure 20 - Marking of packages</span></p>
</center><p><span>Then I created the parent queue - que. After that, I added a new queue (ssh) with a higher priority for ssh traffic (a packet marked ssh). For packages without a label, I created a queue “every” with priority 8 (Figure 21).</span></p><center>
<p><img src="https://i.imgur.com/KU3BdD6.png" alt="" loading="lazy"><br>
<span>Figure 21 - queue simple print</span></p>
</center><p><span>Let’s check if it works (Figure 22).</span></p><center>
<p><img src="https://i.imgur.com/qfQjBC2.png" alt="" loading="lazy"><br>
<span>Figure 22 - Traffic prioritization</span></p>
</center><p><span>For the first 13 seconds, only the bandwidth test is performed. At the 13th second, I started downloading, and the test value dropped to 6 M/s, while the download speed is maximum (61 M/s)</span></p><p><span>The download was completed at the 43rd second, after which the testing speed began to grow as shown in Figure 23.</span></p><center>
<p data-original-title="" title=""><img src="https://i.imgur.com/4wLba48.png" alt="" loading="lazy"><br>
<span>Figure 23 - Bandwidth Test Values</span></p>
</center><hr><div class="alert alert-success">
<ol start="6">
<li><span>What is the difference between the QoS rules to traffic allocation and priority-based QoS? Try to set up each of them and show then them. In which tasks of this lab do you use one or the other? This is mostly theoretical question.</span></li>
</ol>
</div><p><span>With the help of QoS rules for traffic allocation, we can set different bandwidths for different packets, but they will be processed under the same conditions. On the other hand, priority-based QoS benefits higher priority traffic, which is a more dynamic solution.</span></p><hr><div class="alert alert-success">
<ol start="7">
<li><span>Choice and install any tool that you like for bandwidth control/netflow analysis/network control &amp; monitoring. Play around with the tool features and show the different network metrics via GUI.</span><br>
<span>Hint: for example, you can use ntopng.</span><br>
<span>Bonus: try to apply and verify any QoS rule/mechanism that you are interested in (this may be your new idea or one of the QoS configuration that you set up in the lab earlier).</span></li>
</ol>
</div><p><span>I installed </span><code>ntopng</code><span> in PC3. then I started it with the command </span><code>sudo ntopng -w 10.2.1.2:8080</code><span>. It will launch </span><code>ntopng</code><span> as an HTTP page on 10.2.1.2 on port 8080. To access it, I need to configure port forwarding as shown in Figure 24.</span></p><center>
<p><img src="https://i.imgur.com/sheIf47.png" alt="" loading="lazy"><br>
<span>Figure 24 - Port forwarding</span></p>
</center><p><span>So now I can access it by 192.168.122.213:8080 (Figure 25).</span></p><center>
<p><img src="https://i.imgur.com/QZ89e3O.png" alt="" loading="lazy"><br>
<span>Figure 25 - ntopng page</span></p>
</center><p><span>Let’s see its metrics. The first one is top flow talkers.</span></p><center>
<p><img src="https://i.imgur.com/iXKjonq.png" alt="" loading="lazy"><br>
<span>Figure 26 - Top flow talkers</span></p>
</center><p><span>It doesn’t give me much information.</span></p><p><span>I can get more from host (Figures 27, 28) statistics.</span></p><center>
<p><img src="https://i.imgur.com/BGM5g9f.png" alt="" loading="lazy"><br>
<span>Figure 27 - Hosts</span></p>
<p><img src="https://i.imgur.com/BERiUfd.png" alt="" loading="lazy"><br>
<span>Figure 28 - Host statistics</span></p>
</center><p><span>It  shows traffic, reception-transmission ratio, number of flows, etc. Detailed information about the node. Addresses of various levels, traffic, a number of sections on top, where you can see more in-depth details on a specific host.</span></p><p><span>Similar information can be obtained from the port metrics (Figure 29).</span></p><center>
<p><img src="https://i.imgur.com/ILDqJbm.png" alt="" loading="lazy"><br>
<span>Figure 29 - Ports metrics</span></p>
</center><p><span>The “flows" window shows traffic, the reception-transmission ratio, etc. for streams. There are a number of filters above the table on the right. I’ve filtered by total bytes (Figure 30).</span></p><center>
<p><img src="https://i.imgur.com/ETgca61.png" alt="" loading="lazy"><br>
<span>Figure 30 - Active Flows</span></p>
</center><p><span>I can get information for a specific interface such as ens3 (Figures 31, 32). And even write it in a pcap file.</span></p><center>
<p><img src="https://i.imgur.com/cyaN2Bl.png" alt="" loading="lazy"><br>
<span>Figure 31 - Interface information</span></p>
<p><img src="https://i.imgur.com/Fagg5Dr.png" alt="" loading="lazy"><br>
<span>Figure 32 - Interface information</span></p>
</center><p><span>There is a timeline where you can see the traffic load of the canvas or interface at a certain point in time and see the TOP subscribers who create the most traffic (Figure 33).</span></p><center>
<p><img src="https://i.imgur.com/KgwlbYL.png" alt="" loading="lazy"><br>
<span>Figure 33 - Timeline</span></p>
</center><hr><div class="alert alert-success">
<ol start="8">
<li><span>Try to answer the question: packet drops can occur even in an unloaded network where there is no queue overflow. In what cases and why does this happen?</span></li>
</ol>
</div><ol>
<li><span>Packet size could be bigger than MTU (Maximum Transmission Unit).</span></li>
<li><span>Faulty hardware can also cause packet loss.</span></li>
<li><span>Incorrect configuration of the router may also be the cause.</span></li>
</ol><hr><h2 id="Task-3---QoS-verification-amp-packets-analysis" data-id="Task-3---QoS-verification-amp-packets-analysis"><a class="anchor hidden-xs" href="#Task-3---QoS-verification-amp-packets-analysis" title="Task-3---QoS-verification-amp-packets-analysis"><span class="octicon octicon-link"></span></a><span>Task 3 - QoS verification &amp; packets analysis</span></h2><div class="alert alert-success">
<ol>
<li><span>How can you check if your QoS rules are applied correctly? List and describe the various methods.</span></li>
</ol>
</div><ol>
<li><span>Viewing the implemented rules - we can see the status of the rule in the menu (invalid, disabled, …). So if there are any errors, we can see them.</span></li>
<li><span>Viewing system statistics and statistic summary information - </span><code>print stats</code><span>, for example, </span><code>queue simple print stats</code><span> will show statistics on uploading and downloading bytes and packets for each rule (You can see it in bonus task).</span></li>
<li><span>A network analysis tool such as ntopng will show statistics that can also be used.</span></li>
</ol><hr><div class="alert alert-success">
<ol start="2">
<li><span>Try to use Wireshark to see the QoS packets. How does this depend on the number of routers in the network topology?</span></li>
</ol>
</div><p><span>I can’t see my mark (ssh) on the packets, but I can change the DSCP value by adding a new firewall rule with the action=change-dscp as shown in Figure 34.</span></p><center>
<p><img src="https://i.imgur.com/8wHXlL8.png" alt="" loading="lazy"><br>
<span>Figure 34 - New firewall rule</span></p>
</center><p><span>Now I see that all SSH packets have a new DSCP - AF23, while TCP still has 2 (Figure 35).</span></p><center>
<p><img src="https://i.imgur.com/hvt39Vp.png" alt="" loading="lazy"><br>
<span>Figure 35 - SSH packets have a new DSCP - AF23</span></p>
</center><hr><blockquote>
<p><span>How does this depend on the number of routers in the network topology?</span></p>
<blockquote>
<p><span>Each router can rewrite information about QoS.</span></p>
</blockquote>
</blockquote><hr><h2 id="Bonus---Two-routers" data-id="Bonus---Two-routers"><a class="anchor hidden-xs" href="#Bonus---Two-routers" title="Bonus---Two-routers"><span class="octicon octicon-link"></span></a><span>Bonus - Two routers</span></h2><div class="alert alert-success">
<ol>
<li><span>Edit your network scheme to use 2 hosts and 2 routers, each one of them has a different subnet, and the 2 hosts should be able to reach each other (direct connection between the routers and static routes is more than enough) and redo task 2.</span></li>
</ol>
</div><p><span>I have edited my network scheme to use 2 hosts and 2 routers as shown in Figure 36.</span></p><center>
<p><img src="https://i.imgur.com/NID6zIb.png" alt="" loading="lazy"><br>
<span>Figure 36 - Modified topology</span></p>
</center><p><span>Then I configured the IP addresses for the routers: 10.5.1.1 for MikroTik1, 10.6.1.1 for MikroTik2. After that, I configured PC5 and PC6 using netplan, as I already did in the first task. Also, I need to configure NAT and routes between routers (Figures 37, 38).</span></p><center>
<p><img src="https://i.imgur.com/jPHjzJ2.png" alt="" loading="lazy"><br>
<span>Figure 37 - Configuring NAT and routes for MikroTik1</span></p>
<p><img src="https://i.imgur.com/KqpkJd1.png" alt="" loading="lazy"><br>
<span>Figure 38 - Configuring NAT and routes for MikroTik2</span></p>
</center><p><span>Now I should have internet access and a connection between computers (Figures 39, 40).</span></p><center>
<p><img src="https://i.imgur.com/kYd18Ok.png" alt="" loading="lazy"><br>
<span>Figure 39 - Checking connections</span></p>
<p data-original-title="" title=""><img src="https://i.imgur.com/yfrXNnO.png" alt="" loading="lazy"><br>
<span>Figure 40 - Checking connections</span></p>
</center><hr><p><span>Now I can redo the second task. First I get rid of the restrictions with the command:</span><br>
<code>system license renew account=vovacet12@mail.ru password=GxmuD46G1k level=p-unlimited</code></p><p><span>Then I created a QoS rule for MikroTik1. Then I created a 500M file and sent it from PC6 to PC5. But first let’s check the stats of our rule (Figure 41).</span></p><center>
<p><img src="https://i.imgur.com/Yymr3c8.png" alt="" loading="lazy"><br>
<span>Figure 41 - Stats of queue simple rule</span></p>
</center><p><span>So what should happen now? Our rule only applies to the 10.1.1.0/24 subnet, so PC6 will send files with unlimited speed, while PC5 is limited to 10M. This will cause the queue to overflow, so some of our packets will be dropped.</span><br>
<span>I don’t wait for the process to be completed and check the statistics (Figure 42).</span></p><center>
<p><img src="https://i.imgur.com/l645tVT.png" alt="" loading="lazy"><br>
<span>Figure 42 - Stats of queue simple rule</span></p>
</center><p><span>There are 26 packets in the queue and already 438 dropped packets. To fix this, I’m creating the same rule in MikroTik 2. Let’s look at the statistics now (Figure 43)</span></p><center>
<p><img src="https://i.imgur.com/6QGR7bp.png" alt="" loading="lazy"><br>
<span>Figure 43 - Stats of queue simple rule</span></p>
</center><p><span>Figure 44 shows bandwidth limitation.</span></p><center>
<p><img src="https://i.imgur.com/AkycinK.png" alt="" loading="lazy"><br>
<span>Figure 44 - Bandwidth limit up to 10M</span></p>
</center><p><span>So the limitation works. I’m going to prioritize traffic over port 8080 over bandwidth test. To do this, I created new QoS rules (Figure 46) and added a firewall rule (Figure 45) for marking packets.</span></p><center>
<p><img src="https://i.imgur.com/03duRN6.png" alt="" loading="lazy"><br>
<span>Figure 45 - Firewall rule</span></p>
</center><p><span>I mark all traffic with port 8080 as destination or/and source. This rule is implemented on all routers.</span></p><center>
<p><img src="https://i.imgur.com/vpLgyim.png" alt="" loading="lazy"><br>
<span>Figure 46 - QoS rules</span></p>
</center><p><code>limit</code><span> is the parent queue with a max-limit=98M. Then there is an ssh queue for traffic with mark </span><code>ssh</code><span>. It has priority 1. All unmarked traffic passes through </span><code>every</code><span> queue with priority 8.</span></p><p><span>Let’s check the bandwidth test only (Figure 47).</span></p><center>
<p><img src="https://i.imgur.com/MTwUbdI.png" alt="" loading="lazy"><br>
<span>Figure 47 - Running a bandwidth test</span></p>
</center><p><span>Let’s check if it works with the download (started at the 9th second) in Figure 48.</span></p><center>
<p><img src="https://i.imgur.com/fsuDbfs.png" alt="" loading="lazy"><br>
<span>Figure 48 - Bandwidth test and downloading file</span></p>
</center><p><span>The task with ntopng will be pretty similar, so I’m not going to do that.</span></p><div class="alert alert-success">
<ol start="2">
<li><span>Do you need to write QoS rules for each router? Is there a way to let the other routers know that this packet has more priority over the other packets?</span></li>
</ol>
</div><p><span>The QoS rules are individual for each router, but it  slightly dependent on the topology. We can configure DSCP so that the other routers know that this packet should have a higher priority.</span></p><div class="alert alert-success">
<ol start="3">
<li><span>Try to deploy your network scheme over IPv6.</span></li>
</ol>
</div><p><span>I enabled the IPv6 package and rebooted the router: system package enable ipv6 followed by a </span><code>system reboot</code><span>. Then I set the IPv6 IP addresses for the routers as shown in Figure 49.</span></p><center>
<p><img src="https://i.imgur.com/XmkIKMq.png" alt="" loading="lazy"><br>
<span>Figure 49 - IPv6 IP addresses for the routers</span></p>
</center><p><span>I have enabled advertising, so PCs will automatically receive IPv6 addresses. So after reboot, I should see IPv6 addresses there (Figure 50).</span></p><center>
<p><img src="https://i.imgur.com/HYX05Xe.png" alt="" loading="lazy"><br>
<span>Figure 50 - PCs received IPv6 addresses</span></p>
</center><p><span>So, here are their IPv6 addresses:</span></p><ul>
<li><span>PC5 - </span><code>fe12:0:12:2:e9c:1eff:fee6:0</code><span>;</span></li>
<li><span>PC6 - </span><code>fe12:0:12:3:ea1:7bff:fe0b:0</code><span>.</span></li>
</ul><p><span>All I have to do is add routes between them, as shown in Figure 51.</span></p><center>
<p><img src="https://i.imgur.com/UTIwHfX.png" alt="" loading="lazy"><br>
<span>Figure 51 - Adding routes between PCs</span></p>
</center><p><span>Now I have to have a connection between them (Figure 52).</span></p><center>
<p><img src="https://i.imgur.com/JrOLrTi.png" alt="" loading="lazy"><br>
<span>Figure 52 - Checking connections</span></p>
</center><hr><p><span>Now let’s change the QoS rules for IPv6. First, just add a new marking, as shown in Figure 53.</span></p><center>
<p><img src="https://i.imgur.com/LYa4Ekc.png" alt="" loading="lazy"><br>
<span>Figure 53 - Firewall rule</span></p>
</center><p><span>Then I did a bandwidth test. To do this, I started the iperf server on PC6 and connected PC5 to it (Figure 54).</span></p><center>
<p><img src="https://i.imgur.com/Pb3m4b7.png" alt="" loading="lazy"><br>
<span>Figure 54 - Bandwidth test</span></p>
</center><div class="alert alert-info">
<p><span>Server: iperf -s -p 5123 -i 5 -V</span><br>
<span>Client: iperf -V -c fe12:0:12:3:ea1:7bff:fe0b:0 -p 5123 -t 30 -i 5</span></p>
</div><p><span>Now let’s limit it to 20M by adding new rules to the queue as shown in Figure 55.</span></p><center>
<p><img src="https://i.imgur.com/dBefUAO.png" alt="" loading="lazy"><br>
<span>Figure 55 - QoS rules for IPv6 restriction</span></p>
</center><p><span>A similar rule applies to MikroTik 1. Now let’s check it out (Figure 56).</span></p><center>
<p><img src="https://i.imgur.com/zYdDDGv.png" alt="" loading="lazy"><br>
<span>Figure 56 - Bandwidth limit up to 20M</span></p>
</center><hr><p><span>So it works. I changed the topology by adding PC7, which will be iperf client as shown in Figure 57.</span></p><center>
<p><img src="https://i.imgur.com/tnD78sl.png" alt="" loading="lazy"><br>
<span>Figure 57 - Modified topology (added PC7)</span></p>
</center><p><span>Now let’s set the downloading priority over iperf. To do this, I have added new QoS rules, which are shown in Figure 58.</span></p><center>
<p><img src="https://i.imgur.com/mYukzuG.png" alt="" loading="lazy"><br>
<span>Figure 58 - queue simple rules</span></p>
</center><p><span>So let’s check it out. Here is the command for each computer:</span></p><div class="alert alert-info">
<p><span>PC6: nc -6 -l -p 8080 &gt; txt | iperf -s -p 5123 -i 5 -V</span></p>
<p><span>It will launch a socket on port 8080 for IPv6 and write the traffic to a txt file.</span></p>
<p><span>PC7: iperf -V -c fe12:0:12:3:ea1:7bff:fe0b:0 -p 5123 -t 100 -i 5</span></p>
<p><span>It will connect to fe 12:0:12:3:ea 1:7bff:fe0b:0 to check bandwith.</span></p>
<p><span>PC5:  cat txt | nc fe12:0:12:3:ea1:7bff:fe0b:0 8080</span></p>
<p><span>It will send a </span><code>txt</code><span> file to PC6.</span></p>
</div><p><span>Figure 59 shows the test result.</span></p><center>
<p><img src="https://i.imgur.com/J4baRVe.png" alt="" loading="lazy"><br>
<span>Figure 59 - Bandwidth test result</span></p>
</center><p><span>The download started at the 6th second. Thus, we see that the first value is close to the maximum (98 M), but then it dropped to 49 M and below. So it works. Also, let’s check how it works with the bandwidth test only (Figure 60).</span></p><center>
<p><img src="https://i.imgur.com/ajpPGUH.png" alt="" loading="lazy"><br>
<span>Figure 60 - Bandwidth test only</span></p>
</center><hr><h2 id="References" data-id="References"><a class="anchor hidden-xs" href="#References" title="References"><span class="octicon octicon-link"></span></a><span>References</span></h2><ol>
<li><a href="https://ubuntu.com/server/docs/network-configuration" target="_blank" rel="noopener"><span>Network configuration</span></a></li>
<li><a href="https://mikrotik.com" target="_blank" rel="noopener"><span>MikroTik</span></a></li>
<li><a href="https://wiki.mikrotik.com/wiki/Manual:CHR" target="_blank" rel="noopener"><span>Manual:CHR</span></a></li>
<li><a href="https://serveradmin.ru/mikrotik-qos-queue/" target="_blank" rel="noopener"><span>Configuring QOS in Mikrotik</span></a></li>
<li><a href="https://www.cisco.com/c/en/us/support/docs/quality-of-service-qos/qos-policing/22833-qos-faq.html" target="_blank" rel="noopener"><span>QoS</span></a></li>
<li><a href="https://iperf.fr/iperf-servers.php" target="_blank" rel="noopener"><span>Public iPerf3 servers</span></a></li>
<li><a href="https://www.pathsolutions.com/blog/diagnose-and-fix-packet-loss" target="_blank" rel="noopener"><span>Diagnose and Fix Packet Loss in Your Network</span></a></li>
<li><a href="https://en.wikipedia.org/wiki/Jumbo_frame#Baby_giant_frames" target="_blank" rel="noopener"><span>Jumbo frame</span></a></li>
<li><a href="https://www.cisco.com/c/en/us/support/docs/quality-of-service-qos/qos-policing/19645-policevsshape.html" target="_blank" rel="noopener"><span>Comparing Traffic Policing and Traffic Shaping for Bandwidth Limiting</span></a></li>
<li><a href="https://doc.lagout.org/network/Computer%20Networks_%20A%20Systems%20Approach%2C%203rd%20Edition-Petersen.pdf" target="_blank" rel="noopener"><span>Computer Network A Systems Approach by Larry L. Peterson &amp; Bruce S. Davie</span></a></li>
</ol></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li><a href="#AN-Lab-1---QoS" title="AN Lab 1 - QoS">AN Lab 1 - QoS</a><ul class="nav">
<li><a href="#Task-1---Prepare-your-network-topology" title="Task 1 - Prepare your network topology">Task 1 - Prepare your network topology</a></li>
<li><a href="#Task-2---QoS-learning-amp-configuring" title="Task 2 - QoS learning &amp; configuring">Task 2 - QoS learning &amp; configuring</a></li>
<li><a href="#Task-3---QoS-verification-amp-packets-analysis" title="Task 3 - QoS verification &amp; packets analysis">Task 3 - QoS verification &amp; packets analysis</a></li>
<li><a href="#Bonus---Two-routers" title="Bonus - Two routers">Bonus - Two routers</a></li>
<li><a href="#References" title="References">References</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li><a href="#AN-Lab-1---QoS" title="AN Lab 1 - QoS">AN Lab 1 - QoS</a><ul class="nav">
<li><a href="#Task-1---Prepare-your-network-topology" title="Task 1 - Prepare your network topology">Task 1 - Prepare your network topology</a></li>
<li><a href="#Task-2---QoS-learning-amp-configuring" title="Task 2 - QoS learning &amp; configuring">Task 2 - QoS learning &amp; configuring</a></li>
<li><a href="#Task-3---QoS-verification-amp-packets-analysis" title="Task 3 - QoS verification &amp; packets analysis">Task 3 - QoS verification &amp; packets analysis</a></li>
<li><a href="#Bonus---Two-routers" title="Bonus - Two routers">Bonus - Two routers</a></li>
<li><a href="#References" title="References">References</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
